<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WASM Image Magick Legacy</title>
    <style>
        body {
            background-color: black;
            color: white;
            font-family: sans-serif;
            margin: 50px 50px 600px 50px;
        }
        input[type=number] {
            width: 60px;
            text-align: right;
        }
        input[type=radio], input[type=checkbox] {
            display: inline-block;
            margin-right: 5px;
        }
        #palette {
            line-height: 34px;
        }
        .color {
            display: inline-block;
            margin-right: 7px;
        }
        .color .square {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 1px solid white;
            vertical-align: -3px;
            margin-right: 3px;
        }
        h2 {
            border-top: 1px solid white;
            line-height: 40px;
        }
        #kernelPreview {
            border: 1px solid silver;
        }
        .fixedWidth {
            display: inline-block;
            width: 50px;
            text-align: right;
            background-color: white;
            color: black;
            padding: 1px 3px;
        }
    </style>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
    <script src="imagick.js"></script>
    <script src="im.js"></script>
    <script>

        let onResizeButton = () => {
            IMCmdResize($('#src'), $('#width').val(), $('#height').val(), $('#filters').val(), $('#resized'));
        };
        let onCharcoalButton = () => {
            IMCharcoal($('#src'), $('#charcoalRadius').val(), $('#charcoalSigma').val(), $('#charcoaled'));
        };
        let onSketchButton = () => {
            IMSketch($('#src'), $('#sketchRadius').val(), $('#sketchSigma').val(), $('#sketchAngle').val(), $('#sketched'));
        };
        let onQuantizeButton = () => {
            IMQuantize($('#src'), $('#quantizeNumber').val(), IMEnumColorspaces.indexOf($('#quantizeColorSpace').val()), $('#quantizeTreeDepth').val(), $('#quantizeDither').is(':checked'), $('#quantizeErrorCorrection').is(':checked'), $('#quantized'));
        };
        let onQuantizeListButton = () => {
            let colors = IMQuantizeAndListUniqueColors($('#src'), $('#quantizeListNumber').val());
            if (!Array.isArray(colors)) return;
            $('#quantizeListNumberColors').text('('+colors.length+' color'+(colors.length>1?'s':'')+')');
            let $container = $('#quantizeListPalette');
            $container.empty();
            for (color of colors) {
                let $color = $('<span class="color" />');
                let $square = $('<span class="square" />');
                let rgb_string = 'rgb('+color.join(',')+')';
                $square.css('background-color', rgb_string);
                $color.text(rgb_string);
                $color.prepend($square);
                $container.append($color);
            }
        };
        let onQuantizedLoaded = () => {
            let colors = IMListUniqueColors($('#quantized'));
            if (!Array.isArray(colors)) return;
            $('#numberColors').text('('+colors.length+' color'+(colors.length>1?'s':'')+')');
            let $container = $('#palette');
            $container.empty();
            for (color of colors) {
                let $color = $('<span class="color" />');
                let $square = $('<span class="square" />');
                $square.css('background-color', color);
                $color.text(color);
                $color.prepend($square);
                $container.append($color);
            }
        };
        let onColorButton = () => {
            IMColors($('#src'), $('#colorNumber').val(), $('#colorDither').val(), $('#colored'));
        };
        let onColoredLoaded = () => {
            let colors = IMListUniqueColors($('#colored'));
            if (!Array.isArray(colors)) return;
            $('#colorNumberColors').text('('+colors.length+' color'+(colors.length>1?'s':'')+')');
            let $container = $('#colorPalette');
            $container.empty();
            for (color of colors) {
                let $color = $('<span class="color" />');
                let $square = $('<span class="square" />');
                $square.css('background-color', color);
                $color.text(color);
                $color.prepend($square);
                $container.append($color);
            }
        };
        let onPosterizeButton = () => {
            IMPosterize($('#src'), $('#posterizeLevels').val(), $('#posterized'));
        };
        let onPosterizedLoaded = () => {
            let colors = IMListUniqueColors($('#posterized'));
            if (!Array.isArray(colors)) return;
            $('#posterizeNumberColors').text('('+colors.length+' color'+(colors.length>1?'s':'')+')');
            let $container = $('#posterizePalette');
            $container.empty();
            for (color of colors) {
                let $color = $('<span class="color" />');
                let $square = $('<span class="square" />');
                $square.css('background-color', color);
                $color.text(color);
                $color.prepend($square);
                $container.append($color);
            }
        };
        let onAutolevelButton = () => {
            IMAutoLevel($('#src'), $('#autoleveled'), IMEnumChannels[$('#alChannels').val()]);
        };
        let onAutogammaButton = () => {
            IMAutoGamma($('#src'), $('#autogammaed'), IMEnumChannels[$('#agChannels').val()]);
        };
        let onContrastButton = () => {
            let increase = $('input[name=contrastRadio]:checked').val();
            IMContrast($('#src'), $('#contrasted'), increase);
        };
        let onSigmoidalContrastButton = () => {
            IMSigmoidalContrast($('#src'), $('input[name=sigmoidalContrastRadio]:checked').val()==1?0:1, $('#sigmoidalContrast').val(), $('#sigmoidalContrastMidPoint').val(), $('#sigmoidalContrasted'));
        };
        let onSourceChange = () => {
            $('#src').attr('src', $('#source').val());
        };
        let onKernelParamsChange = () => {
            let $morphologyKernel = $('#morphologyKernel');
            let $morphologyKernelParams = $('#morphologyKernelParams');
            let $kernelPreview = $('#kernelPreview');
            $kernelPreview.attr('src', 'kernpresets/kern_' + $morphologyKernel.val() + '-' + $morphologyKernelParams.val() + '.gif');
        }
        let onKernelChange = () => {
            let $morphologyKernel = $('#morphologyKernel');
            let $morphologyKernelParams = $('#morphologyKernelParams');
            let k = $morphologyKernel.val();
            $morphologyKernelParams.empty();
            for (const params of IMEnumKernels[k]) {
                let $opt = $('<option />');
                $opt.val(params);
                $opt.text(params);
                $morphologyKernelParams.append($opt);
            }
            onKernelParamsChange();
        }
        let onMorphologyButton = () => {
            IMMorphology($('#src'), $('#morphologyMethod').val(), $('#morphologyKernel').val() + ':' +  $('#morphologyKernelParams').val(), $('#morphologied'));
        }
        let onExposureButton = () => {
            IMExposure($('#src'), parseFloat($('#exposureStops').val()), parseFloat($('#exposureOffset').val()), parseFloat($('#exposureGamma').val()), $('#exposured'));
        }
        let onGlowButton = () => {
            IMGlow($('#src'), parseFloat($('#glowAmount').val()), parseInt($('#glowSoftening').val()), $('#glowed'));
        }
        let onSobelButton = () => {
            IMSobel($('#src'), $('#sobeled'));
        };
        let onWatercolorButton = () => {
            IMWatercolor(
                $('#src'),
                parseInt($('#watercolorSmoothing').val()),
                parseFloat($('#watercolorEdge').val()),
                parseInt($('#watercolorMixing').val()),
                parseFloat($('#watercolorContrast').val()),
                $('#watercolored')
            );
        };
        let onDisperseButton = () => {
            IMDisperse(
                $('#src'),
                parseInt($('#disperseSpread').val()),
                parseInt($('#disperseDensity').val()),
                parseInt($('#disperseCurviness').val()),
                parseInt($('#disperseReseed').val()),
                $('#dispersed')
            );
        };
        let onCrystallizeButton = () => {
            IMCrystallize(
                $('#src'),
                parseInt($('#crystallizeNumber').val()),
                parseInt($('#crystallizeSeed').val()),
                $('#crystallized')
            );
        };
        let onSoftLightButton = () => {
            IMSoftLight(
                $('#src'),
                parseInt($('#softLightIntensity').val()),
                parseInt($('#softLightSmooth').val()),
                parseInt($('#softLightPercent').val()),
                $('#softLightColor').val(),
                $('#softLighted')
            );
        };
        let onDaveHillEffectButton = () => {
            IMDaveHillEffect(
                $('#src'),
                parseFloat($('#daveHillEffectBrightness').val()),
                parseFloat($('#daveHillEffectContrast').val()),
                parseInt($('#daveHillEffectGain').val()),
                $('#daveHillEffected')
            );
        };
        let onFrostedButton = () => {
            IMFrosted(
                $('#src'),
                parseInt($('#frostedSpread').val()),
                parseInt($('#frostedBlur').val()),
                parseInt($('#frostedSeed').val()),
                $('#frosted')
            );
        };
        let onLucisArtEffectButton = () => {
            IMLucisArtEffect(
                $('#src'),
                parseFloat($('#lucisArtEffectGain').val()),
                parseInt($('#lucisArtEffectSaturation').val()),
                $('#lucisArtEffected')
            );
        };
        let onShadowHighlightButton = () => {
            IMShadowHighlight(
                $('#src'),
                parseInt($('#shadowHighlightShadowAmount').val()),
                parseInt($('#shadowHighlightShadowWidth').val()),
                parseFloat($('#shadowHighlightShadowRadius').val()),
                parseInt($('#shadowHighlightHighLightAmount').val()),
                parseInt($('#shadowHighlightHighLightWidth').val()),
                parseFloat($('#shadowHighlightHighLightRadius').val()),
                parseInt($('#shadowHighlightMidtoneAmount').val()),
                parseInt($('#shadowHighlightColorCorrectionAmount').val()),
                parseFloat($('#shadowHighlightBlackClip').val()),
                parseFloat($('#shadowHighlightWhiteClip').val()),
                $('#shadowHighlighted')
            );
        };
        let onUnsaturateHueButton = () => {
            IMUnsaturateHue(
                $('#src'),
                parseInt($('#unsaturateHueHue').val()),
                parseInt($('#unsaturateHueSaturation').val()) + 100,
                parseInt($('#unsaturateHueTolerance').val()),
                parseInt($('#unsaturateHueRamping').val()),
                0,
                $('#unsaturateHued')
            );
        }
        let onTurbulenceButton = () => {
            IMTurbulence(
                $('#src'),
                parseInt($('#turbulenceMethod').val()),
                parseInt($('#turbulenceDistance').val()),
                parseInt($('#turbulenceDistance').val()),
                parseInt($('#turbulenceSmooth').val()),
                parseInt($('#turbulenceChannels').val()),
                $('#turbulenced')
            );
        }
        let onToWebPButton = async () => {
            let data = await IMToWebP(
                $('#src'),
                parseInt($('#toWebPQuality').val()),
                $('#toWebPLossless').is(':checked')?1:0,
                parseInt($('#toWebPMethod').val())
            );
            $('#webped').attr('src', data.base64url);
            $('#webpsize').text(data.size);
            if (data.size > 1) $('#webpsizeplural').text('s');
            else $('#webpsizeplural').text('');
        }
        let onIMReady = () => {
            let $filters = $('#filters');
            const sortedFilters = [...IMEnumFilters].sort();
            for (const filter of sortedFilters) {
                let $opt = $('<option />');
                $opt.val(filter);
                $opt.text(filter);
                if (filter === 'Default') $opt.prop('selected', true);
                $filters.append($opt);
            }
            for (const channelsId of ['#alChannels', '#agChannels']) {
                let $channels = $(channelsId);
                for (channel of Object.keys(IMEnumChannels)) {
                    let $opt = $('<option />');
                    $opt.val(channel);
                    $opt.text(channel);
                    if (channel === 'RGB') $opt.prop('selected', true);
                    $channels.append($opt);
                }
            }
            let $ditherSelect = $('#colorDither');
            for (const dither of Object.keys(IMEnumDithers)) {
                let $opt = $('<option />');
                $opt.val(dither);
                $opt.text(IMEnumDithers[dither][2]);
                if (dither === 'FloydSteinberg') $opt.prop('selected', true);
                $ditherSelect.append($opt);
            }
            let $quantizeColorSpace = $('#quantizeColorSpace');
            for (const colorspace of IMEnumColorspaces) {
                let $opt = $('<option />');
                $opt.val(colorspace);
                $opt.text(colorspace);
                if (colorspace === 'sRGB') $opt.prop('selected', true);
                $quantizeColorSpace.append($opt);
            }
            let $morphologyMethod = $('#morphologyMethod');
            for (const method of IMEnumMorphologies) {
                let $opt = $('<option />');
                $opt.val(method);
                $opt.text(method);
                if (method === 'Dilate') $opt.prop('selected', true);
                $morphologyMethod.append($opt);
            }
            let $morphologyKernel = $('#morphologyKernel');
            for (const kernel of Object.keys(IMEnumKernels)) {
                let $opt = $('<option />');
                $opt.val(kernel);
                $opt.text(kernel);
                $morphologyKernel.append($opt);
                if (kernel === 'Octagon') {
                    $opt.prop('selected', true);
                    onKernelChange();
                }
            }
            $('#exposureStops').on('input', () => {
                $('#exposureStopsDisplay').text($('#exposureStops').val());
            });
            $('#exposureOffset').on('input', () => {
                $('#exposureOffsetDisplay').text($('#exposureOffset').val());
            });
            $('#exposureGamma').on('input', () => {
                $('#exposureGammaDisplay').text($('#exposureGamma').val());
            });
            $('#glowAmount').on('input', () => {
                $('#glowAmountDisplay').text($('#glowAmount').val());
            });
            $('#glowSoftening').on('input', () => {
                $('#glowSofteningDisplay').text($('#glowSoftening').val());
            });
            $('#watercolorSmoothing').on('input', () => {
                $('#watercolorSmoothingDisplay').text($('#watercolorSmoothing').val());
            });
            $('#watercolorEdge').on('input', () => {
                $('#watercolorEdgeDisplay').text($('#watercolorEdge').val());
            });
            $('#watercolorMixing').on('input', () => {
                $('#watercolorMixingDisplay').text($('#watercolorMixing').val());
            });
            $('#watercolorContrast').on('input', () => {
                $('#watercolorContrastDisplay').text($('#watercolorContrast').val());
            });
            
            $('#disperseSpread').on('input', () => {
                $('#disperseSpreadDisplay').text($('#disperseSpread').val());
            });
            $('#disperseDensity').on('input', () => {
                $('#disperseDensityDisplay').text($('#disperseDensity').val());
            });
            $('#disperseCurviness').on('input', () => {
                $('#disperseCurvinessDisplay').text($('#disperseCurviness').val());
            });
            $('#disperseReseed').on('input', () => {
                $('#disperseReseedDisplay').text($('#disperseReseed').val());
            });
            $('#crystallizeNumber').on('input', () => {
                $('#crystallizeNumberDisplay').text($('#crystallizeNumber').val());
            });
            $('#crystallizeSeed').on('input', () => {
                $('#crystallizeSeedDisplay').text($('#crystallizeSeed').val());
            });
            $('#softLightIntensity').on('input', () => {
                $('#softLightIntensityDisplay').text($('#softLightIntensity').val());
            });
            $('#softLightSmooth').on('input', () => {
                $('#softLightSmoothDisplay').text($('#softLightSmooth').val());
            });
            $('#softLightPercent').on('input', () => {
                $('#softLightPercentDisplay').text($('#softLightPercent').val());
            });
            $('#daveHillEffectBrightness').on('input', () => {
                $('#daveHillEffectBrightnessDisplay').text($('#daveHillEffectBrightness').val());
            });
            $('#daveHillEffectContrast').on('input', () => {
                $('#daveHillEffectContrastDisplay').text($('#daveHillEffectContrast').val());
            });
            $('#daveHillEffectGain').on('input', () => {
                $('#daveHillEffectGainDisplay').text($('#daveHillEffectGain').val());
            });
            $('#frostedSpread').on('input', () => {
                $('#frostedSpreadDisplay').text($('#frostedSpread').val());
            });
            $('#frostedBlur').on('input', () => {
                $('#frostedBlurDisplay').text($('#frostedBlur').val());
            });
            $('#frostedSeed').on('input', () => {
                $('#frostedSeedDisplay').text($('#frostedSeed').val());
            });
            $('#lucisArtEffectGain').on('input', () => {
                $('#lucisArtEffectGainDisplay').text($('#lucisArtEffectGain').val());
            });
            $('#lucisArtEffectSaturation').on('input', () => {
                $('#lucisArtEffectSaturationDisplay').text($('#lucisArtEffectSaturation').val());
            });
            $('#shadowHighlightShadowAmount').on('input', () => {
                $('#shadowHighlightShadowAmountDisplay').text($('#shadowHighlightShadowAmount').val());
            });
            $('#shadowHighlightShadowWidth').on('input', () => {
                $('#shadowHighlightShadowWidthDisplay').text($('#shadowHighlightShadowWidth').val());
            });
            $('#shadowHighlightShadowRadius').on('input', () => {
                $('#shadowHighlightShadowRadiusDisplay').text($('#shadowHighlightShadowRadius').val());
            });
            $('#shadowHighlightHighLightAmount').on('input', () => {
                $('#shadowHighlightHighLightAmountDisplay').text($('#shadowHighlightHighLightAmount').val());
            });
            $('#shadowHighlightHighLightWidth').on('input', () => {
                $('#shadowHighlightHighLightWidthDisplay').text($('#shadowHighlightHighLightWidth').val());
            });
            $('#shadowHighlightHighLightRadius').on('input', () => {
                $('#shadowHighlightHighLightRadiusDisplay').text($('#shadowHighlightHighLightRadius').val());
            });
            $('#shadowHighlightMidtoneAmount').on('input', () => {
                $('#shadowHighlightMidtoneAmountDisplay').text($('#shadowHighlightMidtoneAmount').val());
            });
            $('#shadowHighlightColorCorrectionAmount').on('input', () => {
                $('#shadowHighlightColorCorrectionAmountDisplay').text($('#shadowHighlightColorCorrectionAmount').val());
            });
            $('#shadowHighlightBlackClip').on('input', () => {
                $('#shadowHighlightBlackClipDisplay').text($('#shadowHighlightBlackClip').val());
            });
            $('#shadowHighlightWhiteClip').on('input', () => {
                $('#shadowHighlightWhiteClipDisplay').text($('#shadowHighlightWhiteClip').val());
            });
            $('#unsaturateHueHue').on('input', () => {
                $('#unsaturateHueHueDisplay').text($('#unsaturateHueHue').val());
                $('#unsaturateHueHueDisplay').css('background-color', 'hsl('+$('#unsaturateHueHue').val()+', 100%, 70%)')
            });
            $('#unsaturateHueSaturation').on('input', () => {
                $('#unsaturateHueSaturationDisplay').text($('#unsaturateHueSaturation').val());
            });
            $('#unsaturateHueTolerance').on('input', () => {
                $('#unsaturateHueToleranceDisplay').text($('#unsaturateHueTolerance').val());
            });
            $('#unsaturateHueRamping').on('input', () => {
                $('#unsaturateHueRampingDisplay').text($('#unsaturateHueRamping').val());
            });
            $('#turbulenceDistance').on('input', () => {
                $('#turbulenceDistanceDisplay').text($('#turbulenceDistance').val());
            });
            $('#turbulenceSmooth').on('input', () => {
                $('#turbulenceSmoothDisplay').text($('#turbulenceSmooth').val());
            });
            $('#toWebPQuality').on('input', () => {
                $('#toWebPQualityDisplay').text($('#toWebPQuality').val());
            });
            $('#toWebPMethod').on('input', () => {
                $('#toWebPMethodDisplay').text($('#toWebPMethod').val());
            });
            $('#toWebPButton').on('click', onToWebPButton);
            $('#turbulenceButton').on('click', onTurbulenceButton);
            $('#unsaturateHueButton').on('click', onUnsaturateHueButton);
            $('#shadowHighlightButton').on('click', onShadowHighlightButton);
            $('#lucisArtEffectButton').on('click', onLucisArtEffectButton);
            $('#frostedButton').on('click', onFrostedButton);
            $('#daveHillEffectButton').on('click', onDaveHillEffectButton);
            $('#softLightButton').on('click', onSoftLightButton);
            $('#crystallizeButton').on('click', onCrystallizeButton);
            $('#disperseButton').on('click', onDisperseButton);
            $('#watercolorButton').on('click', onWatercolorButton);
            $('#sobelButton').on('click', onSobelButton);
            $('#glowButton').on('click', onGlowButton);
            $('#exposureButton').on('click', onExposureButton);
            $morphologyKernel.on('change', onKernelChange);
            $('#morphologyKernelParams').on('change', onKernelParamsChange);
            $('#resizeButton').on('click', onResizeButton);
            $('#charcoalButton').on('click', onCharcoalButton);
            $('#sketchButton').on('click', onSketchButton);
            $('#quantized').on('load', onQuantizedLoaded);
            $('#quantizeButton').on('click', onQuantizeButton);
            $('#quantizeListButton').on('click', onQuantizeListButton);
            $('#colored').on('load', onColoredLoaded);
            $('#colorButton').on('click', onColorButton);
            $('#posterized').on('load', onPosterizedLoaded);
            $('#posterizeButton').on('click', onPosterizeButton);
            $('#autolevelButton').on('click', onAutolevelButton);
            $('#autogammaButton').on('click', onAutogammaButton);
            $('#contrastButton').on('click', onContrastButton);
            $('#sigmoidalContrastButton').on('click', onSigmoidalContrastButton);
            $('#morphologyButton').on('click', onMorphologyButton);
            $('#source').on('change', onSourceChange);
            $('main').show();
        };
        $(() => {
            $(window).on('IMReady', onIMReady);
        });
    </script>
</head>
<body>
    <main style="display: none;">
        <h1>Test WASM ImageMagick Legacy</h1>
        <h2>Source</h2>
        <p><select id="source">
            <option value="peppers.png" selected>peppers.png</option>
            <option value="lena.png">lena.png</option>
            <option value="parrot.jpg">parrot.jpg</option>
            <option value="parrots.png">parrots.png</option>
            <option value="balloons.png">balloons.png</option>
            <option value="wellexposed.png">wellexposed.png</option>
            <option value="overexposed.png">overexposed.png</option>
            <option value="underexposed.png">underexposed.png</option>
            <option value="tulips.jpg">tulips.jpg</option>
            <option value="woman_with_earing.jpg">woman_with_earing.jpg</option>
            <option value="duck_in_pond.jpg">duck_in_pond.jpg</option>
            <option value="hue_grad.png">hue_grad.png</option>
            <option value="hue_grad_half.png">hue_grad_half.png</option>
            <option value="barn.jpg">barn.jpg</option>
            <option value="freckles2.jpg">freckles2.jpg</option>
        </select></p>
        <p><img id="src" src="peppers.png" /></p>
        <h2>Resize</h2>
        <p><label for="width">Width</label> <input id="width" type="number" value="400" /> px, <label for="height">Height</label> <input id="height" type="number" value="400" /> px, <label for="filters">Filter</label> <select id="filters"></select>, <button id="resizeButton" type="button">Resize</button></p>
        <p><img id="resized" /></p>
        <h2>Charcoal</h2>
        <p><label for="charcoalRadius">Radius</label> <input id="charcoalRadius" type="number" value="2" />, <label for="charcoalSigma">Sigma</label> <input id="charcoalSigma" type="number" value="0.5" />, <button id="charcoalButton" type="button">Apply</button></p>
        <p><img id="charcoaled" /></p>
        <h2>Sketch</h2>
        <p><label for="sketchRadius">Radius</label> <input id="sketchRadius" type="number" value="15" />, <label for="sketchSigma">Sigma</label> <input id="sketchSigma" type="number" value="10" />, <label for="sketchAngle">Angle</label> <input id="sketchAngle" type="number" value="-47" />, <button id="sketchButton" type="button">Apply</button> (can be slow)</p>
        <p><img id="sketched" /></p>
        <h2>Quantize</h2>
        <p><label for="quantizeNumber">Number of colors</label> <input id="quantizeNumber" type="number" value="8" />, 
            <label for="quantizeColorSpace">Color space</label>  <select id="quantizeColorSpace"></select>,
            <label for="quantizeTreeDepth">Tree depth</label>  <select id="quantizeTreeDepth">
                <option value="0" selected>0</option>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
            </select>,
            <input id="quantizeDither" type="checkbox" /><label for="quantizeDither">Hilbert Curve Dither</label>,
            <input id="quantizeErrorCorrection" type="checkbox" /><label for="quantizeErrorCorrection">Error Correction</label>,
            <button id="quantizeButton" type="button">Apply</button></p>
        <p><img id="quantized" /></p>
        <h3>Palette <span id="numberColors"></span></h3>
        <p id="palette"></p>
        <h2>Quantize and list unique colors</h2>
        <p><label for="quantizeListNumber">Number of colors</label> <input id="quantizeListNumber" type="number" value="8" />,
            <button id="quantizeListButton" type="button">Apply</button></p>
        <h3>Palette <span id="quantizeListNumberColors"></span></h3>
        <p id="quantizeListPalette"></p>
        <h2>Command "-colors n"</h2>
        <p><label for="colorDither">Dither</label> <select id="colorDither"></select>, <label for="colorNumber">Number of colors</label> <input id="colorNumber" type="number" value="8" />, <button id="colorButton" type="button">Apply</button></p>
        <p><img id="colored" /></p>
        <h3>Palette <span id="colorNumberColors"></span></h3>
        <p id="colorPalette"></p>
        <h2>Posterize</h2>
        <p><label for="posterizeLevels">Levels</label> <input id="posterizeLevels" type="number" value="2" />, <button id="posterizeButton" type="button">Apply</button></p>
        <p><img id="posterized" /></p>
        <h3>Palette <span id="posterizeNumberColors"></span></h3>
        <p id="posterizePalette"></p>
        <h2>Auto level</h2>
        <p><label for="alChannels">Channel(s)</label> <select id="alChannels"></select>, <button id="autolevelButton" type="button">Apply</button></p>
        <p><img id="autoleveled" /></p>
        <h2>Auto gamma</h2>
        <p><label for="agChannels">Channel(s)</label> <select id="agChannels"></select>, <button id="autogammaButton" type="button">Apply</button></p>
        <p><img id="autogammaed" /></p>
        <h2>Contrast</h2>
        <p><input type="radio" id="contrastIncrease" name="contrastRadio" value="1" checked /><label for="contrastIncrease">Increase</label> <input type="radio" id="contrastDecrease" name="contrastRadio" value="0" /><label for="contrastDecrease">Decrease</label>, <button id="contrastButton" type="button">Apply</button></p>
        <p><img id="contrasted" /></p>
        <h2>Sigmoidal contrast</h2>
        <p><input type="radio" id="sigmoidalContrastIncrease" name="sigmoidalContrastRadio" value="1" checked /><label for="sigmoidalContrastIncrease">Increase</label> <input type="radio" id="sigmoidalContrastDecrease" name="sigmoidalContrastRadio" value="0" /><label for="sigmoidalContrastDecrease">Decrease</label>, <label for="sigmoidalContrast">Contrast</label> <input id="sigmoidalContrast" type="number" value="3" />/20, <label for="sigmoidalContrastMidPoint">Mid point</label> <input id="sigmoidalContrastMidPoint" type="number" value="50" />%, <button id="sigmoidalContrastButton" type="button">Apply</button></p>
        <p><img id="sigmoidalContrasted" /></p>
        <h2>Morphology</h2>
        <p><label for="morphologyMethod">Method</label> <select id="morphologyMethod"></select>,
            <label for="morphologyKernel">Kernel</label> <select id="morphologyKernel"></select>,
            <label for="morphologyKernelParams">Parameters</label> <select id="morphologyKernelParams"></select>,
            <button id="morphologyButton" type="button">Apply</button></p>
        <p>Kernel preview<br /><img id="kernelPreview" /></p>
        <p><img id="morphologied" /></p>
        <h2>Exposure</h2>
        <p>According to Fred Weinhaus</p>
        <p>
            <label for="exposureStops">Exposure</label> <input id="exposureStops" type="range" value="1" min="-20" max="20" step="0.01" /> <span class="fixedWidth" id="exposureStopsDisplay">1</span>,
            <label for="exposureOffset">Offset</label> <input id="exposureOffset" type="range" value="0" min="-0.5" max="0.5" step="0.01" /> <span class="fixedWidth" id="exposureOffsetDisplay">0</span>,
            <label for="exposureGamma">Gamma</label> <input id="exposureGamma" type="range" value="1" min="0.01" max="9.99" step="0.01" /> <span class="fixedWidth" id="exposureGammaDisplay">1</span>,
            <button id="exposureButton" type="button">Apply</button>
            <p><img id="exposured" /></p>
        </p>
        <h2>Glow</h2>
        <p>According to Fred Weinhaus</p>
        <p><label for="glowAmount">Amount</label> <input id="glowAmount" type="range" value="1.5" min="1" max="2" step="0.01" /> <span class="fixedWidth" id="glowAmountDisplay">1.5</span>,
        <label for="glowSoftening">Softening</label> <input id="glowSoftening" type="range" value="0" min="0" max="150" step="1" /> <span class="fixedWidth" id="glowSofteningDisplay">0</span>,
        <button id="glowButton" type="button">Apply</button></p>
        <p><img id="glowed" /></p>
        <h2>Sobel</h2>
        <button id="sobelButton" type="button">Apply</button>
        <p><img id="sobeled" /></p>
        <h2>Watercolor</h2>
        <p>According to Fred Weinhaus</p>
        <p><label for="watercolorSmoothing">Smoothing</label> <input id="watercolorSmoothing" type="range" value="0" min="0" max="20" step="1" /> <span class="fixedWidth" id="watercolorSmoothingDisplay">0</span>,
        <label for="watercolorEdge">Edge</label> <input id="watercolorEdge" type="range" value="5" min="1" max="20" step="0.01" /> <span class="fixedWidth" id="watercolorEdgeDisplay">5</span>,
        <label for="watercolorMixing">Mixing</label> <input id="watercolorMixing" type="range" value="33" min="0" max="100" step="1" /> <span class="fixedWidth" id="watercolorMixingDisplay">33</span>,
        <label for="watercolorContrast">Contrast</label> <input id="watercolorContrast" type="range" value="0" min="0" max="30" step="0.01" /> <span class="fixedWidth" id="watercolorContrastDisplay">0</span>,
        <button id="watercolorButton" type="button">Apply</button></p>
        <p><img id="watercolored" /></p>
        <h2>Disperse</h2>
        <p>According to Fred Weinhaus</p>
        <p><label for="disperseSpread">Spread</label> <input id="disperseSpread" type="range" value="5" min="0" max="50" step="1" /> <span class="fixedWidth" id="disperseSpreadDisplay">5</span>,
        <label for="disperseDensity">Density</label> <input id="disperseDensity" type="range" value="5" min="0" max="50" step="1" /> <span class="fixedWidth" id="disperseDensityDisplay">5</span>,
        <label for="disperseCurviness">Curviness</label> <input id="disperseCurviness" type="range" value="5" min="0" max="50" step="1" /> <span class="fixedWidth" id="disperseCurvinessDisplay">5</span>,
        <label for="disperseReseed">Reseed</label> <input id="disperseReseed" type="range" value="-1" min="-1" max="200" step="1" /> <span class="fixedWidth" id="disperseReseedDisplay">-1</span> (-1 = no reseed),
        <button id="disperseButton" type="button">Apply</button></p>
        <p><img id="dispersed" /></p>
        <h2>Crystallize</h2>
        <p>According to Fred Weinhaus</p>
        <p><label for="crystallizeNumber">Number</label> <input id="crystallizeNumber" type="range" value="500" min="25" max="5000" step="25" /> <span class="fixedWidth" id="crystallizeNumberDisplay">500</span>,
        <label for="crystallizeSeed">Seed</label> <input id="crystallizeSeed" type="range" value="0" min="0" max="200" step="1" /> <span class="fixedWidth" id="crystallizeSeedDisplay">0</span>,
        <button id="crystallizeButton" type="button">Apply</button></p>
        <p><img id="crystallized" /></p>
        <h2>Soft light</h2>
        <p>According to Fred Weinhaus</p>
        <p><label for="softLightIntensity">Intensity</label> <input id="softLightIntensity" type="range" value="80" min="0" max="200" step="1" /> <span class="fixedWidth" id="softLightIntensityDisplay">80</span>,
        <label for="softLightSmooth">Smooth</label> <input id="softLightSmooth" type="range" value="50" min="0" max="500" step="1" /> <span class="fixedWidth" id="softLightSmoothDisplay">50</span>,
        <label for="softLightPercent">Percent</label> <input id="softLightPercent" type="range" value="5" min="0" max="100" step="1" /> <span class="fixedWidth" id="softLightPercentDisplay">5</span>,
        <label for="softLightColor">Color</label> <input id="softLightColor" type="color" value="#ffffff" />,
        <button id="softLightButton" type="button">Apply</button></p>
        <p><img id="softLighted" /></p>
        <h2>Dave Hill effect</h2>
        <p>According to Fred Weinhaus</p>
        <p><label for="daveHillEffectBrightness">Brightness</label> <input id="daveHillEffectBrightness" type="range" value="1" min="0" max="2" step="0.01" /> <span class="fixedWidth" id="daveHillEffectBrightnessDisplay">1</span>,
        <label for="daveHillEffectContrast">Contrast</label> <input id="daveHillEffectContrast" type="range" value="0" min="-10" max="10" step="0.01" /> <span class="fixedWidth" id="daveHillEffectContrastDisplay">0</span>,
        <label for="daveHillEffectGain">Gain</label> <input id="daveHillEffectGain" type="range" value="40" min="0" max="100" step="1" /> <span class="fixedWidth" id="daveHillEffectGainDisplay">40</span>,
        <button id="daveHillEffectButton" type="button">Apply</button></p>
        <p><img id="daveHillEffected" /></p>
        <h2>Frosted</h2>
        <p>According to Fred Weinhaus</p>
        <p><label for="frostedSpread">Spread</label> <input id="frostedSpread" type="range" value="5" min="0" max="50" step="1" /> <span class="fixedWidth" id="frostedSpreadDisplay">5</span>,
        <label for="frostedBlur">Blur</label> <input id="frostedBlur" type="range" value="5" min="0" max="50" step="1" /> <span class="fixedWidth" id="frostedBlurDisplay">5</span>,
        <label for="frostedSeed">Seed</label> <input id="frostedSeed" type="range" value="0" min="0" max="200" step="1" /> <span class="fixedWidth" id="frostedSeedDisplay">0</span>,
        <button id="frostedButton" type="button">Apply</button></p>
        <p><img id="frosted" /></p>
        <h2>Lucis art effect</h2>
        <p>According to Fred Weinhaus</p>
        <p><label for="lucisArtEffectGain">Gain</label> <input id="lucisArtEffectGain" type="range" value="0.3" min="0" max="2" step="0.01" /> <span class="fixedWidth" id="lucisArtEffectGainDisplay">0.3</span>,
        <label for="lucisArtEffectSaturation">Saturation</label> <input id="lucisArtEffectSaturation" type="range" value="60" min="0" max="200" step="1" /> <span class="fixedWidth" id="lucisArtEffectSaturationDisplay">60</span>,
        <button id="lucisArtEffectButton" type="button">Apply</button></p>
        <p><img id="lucisArtEffected" /></p>
        <h2>Shadow and high light</h2>
        <p>According to Fred Weinhaus</p>
        <p>
            <label for="shadowHighlightShadowAmount" style="display: inline-block;width: 180px;">Shadow amount</label> <input id="shadowHighlightShadowAmount" type="range" value="50" min="0" max="100" step="1" /> <span class="fixedWidth" id="shadowHighlightShadowAmountDisplay">50</span>,<br />
            <label for="shadowHighlightShadowWidth" style="display: inline-block;width: 180px;">Shadow width</label> <input id="shadowHighlightShadowWidth" type="range" value="50" min="0" max="100" step="1" /> <span class="fixedWidth" id="shadowHighlightShadowWidthDisplay">50</span>,<br />
            <label for="shadowHighlightShadowRadius" style="display: inline-block;width: 180px;">Shadow radius</label> <input id="shadowHighlightShadowRadius" type="range" value="30" min="0" max="100" step="0.01" /> <span class="fixedWidth" id="shadowHighlightShadowRadiusDisplay">30</span>,<br />
            
            <label for="shadowHighlightHighLightAmount" style="display: inline-block;width: 180px;">High light amount</label> <input id="shadowHighlightHighLightAmount" type="range" value="0" min="0" max="100" step="1" /> <span class="fixedWidth" id="shadowHighlightHighLightAmountDisplay">0</span>,<br />
            <label for="shadowHighlightHighLightWidth" style="display: inline-block;width: 180px;">High light width</label> <input id="shadowHighlightHighLightWidth" type="range" value="50" min="0" max="100" step="1" /> <span class="fixedWidth" id="shadowHighlightHighLightWidthDisplay">50</span>,<br />
            <label for="shadowHighlightHighLightRadius" style="display: inline-block;width: 180px;">High light radius</label> <input id="shadowHighlightHighLightRadius" type="range" value="30" min="0" max="100" step="0.01" /> <span class="fixedWidth" id="shadowHighlightHighLightRadiusDisplay">30</span>,<br />

            <label for="shadowHighlightMidtoneAmount" style="display: inline-block;width: 180px;">Midtone amount</label> <input id="shadowHighlightMidtoneAmount" type="range" value="0" min="-100" max="100" step="1" /> <span class="fixedWidth" id="shadowHighlightMidtoneAmountDisplay">0</span>,<br />
            <label for="shadowHighlightColorCorrectionAmount" style="display: inline-block;width: 180px;">Color correction amount</label> <input id="shadowHighlightColorCorrectionAmount" type="range" value="0" min="-100" max="100" step="1" /> <span class="fixedWidth" id="shadowHighlightColorCorrectionAmountDisplay">0</span>,<br />

            <label for="shadowHighlightBlackClip" style="display: inline-block;width: 180px;">Black clip</label> <input id="shadowHighlightBlackClip" type="range" value="0.01" min="0" max="100" step="0.01" /> <span class="fixedWidth" id="shadowHighlightBlackClipDisplay">0.01</span>,<br />
            <label for="shadowHighlightWhiteClip" style="display: inline-block;width: 180px;">White clip</label> <input id="shadowHighlightWhiteClip" type="range" value="0.01" min="0" max="100" step="0.01" /> <span class="fixedWidth" id="shadowHighlightWhiteClipDisplay">0.01</span>,<br />
            <button id="shadowHighlightButton" type="button">Apply</button>
        </p>
        <p><img id="shadowHighlighted" /></p>
        <h2>Unsaturate Hue</h2>
        <p>According to Fred Weinhaus</p>
        <p>
            <label for="unsaturateHueHue">Hue</label> <input id="unsaturateHueHue" type="range" value="0" min="0" max="360" step="1" /> <span class="fixedWidth" id="unsaturateHueHueDisplay" style="background-color: hsl(0, 100%, 70%);">0</span>,
            <label for="unsaturateHueSaturation">Saturation</label> <input id="unsaturateHueSaturation" type="range" value="0" min="-100" max="100" step="1" /> <span class="fixedWidth" id="unsaturateHueSaturationDisplay">0</span>,
            <label for="unsaturateHueTolerance">Tolerance</label> <input id="unsaturateHueTolerance" type="range" value="30" min="0" max="360" step="1" /> <span class="fixedWidth" id="unsaturateHueToleranceDisplay">30</span>,
            <label for="unsaturateHueRamping">Ramping</label> <input id="unsaturateHueRamping" type="range" value="30" min="0" max="360" step="1" /> <span class="fixedWidth" id="unsaturateHueRampingDisplay">30</span>,
            <button id="unsaturateHueButton" type="button">Apply</button>
        </p>
        <p><img id="unsaturateHued" /></p>
        <h2>Turbulence</h2>
        <p>According to Fred Weinhaus</p>
        <p>
            <label for="turbulenceMethod">Method</label> <select id="turbulenceMethod"><option value="0">Displace</option><option value="1">Distort</option></select>, 
            <label for="turbulenceDistance">Distance</label> <input id="turbulenceDistance" type="range" value="20" min="0" max="1000" step="1" /> <span class="fixedWidth" id="turbulenceDistanceDisplay">20</span>,
            <label for="turbulenceSmooth">Smooth</label> <input id="turbulenceSmooth" type="range" value="20" min="0" max="100" step="1" /> <span class="fixedWidth" id="turbulenceSmoothDisplay">20</span>,
            <label for="turbulenceChannels">Channels</label> <select id="turbulenceChannels"><option value="0">Together</option><option value="1">Separate</option></select>, 
            <button id="turbulenceButton" type="button">Apply</button>
        </p>
        <p><img id="turbulenced" /></p>
        <h2>Conversion to WEBP format</h2>
        <p>
            <label for="toWebPQuality">Quality</label> <input id="toWebPQuality" type="range" value="80" min="0" max="100" step="1" /> <span class="fixedWidth" id="toWebPQualityDisplay">80</span>,
            <label for="toWebPLossless">Lossless</label> <input id="toWebPLossless" type="checkbox" />, 
            <label for="toWebPMethod">Optimization</label> <input id="toWebPMethod" type="range" value="4" min="0" max="6" step="1" /> <span class="fixedWidth" id="toWebPMethodDisplay">4</span>, 
            <button id="toWebPButton" type="button">Apply</button>
        </p>
        <p><img id="webped" /><br />Size: <span id="webpsize">0</span> byte<span id="webpsizeplural"></span></p>
    </main>
</body>
</html>